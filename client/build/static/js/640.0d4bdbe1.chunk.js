"use strict";(self.webpackChunkfintools_client=self.webpackChunkfintools_client||[]).push([[640],{43640:(e,r,s)=>{s.r(r),s.d(r,{default:()=>me});var t=s(65043),n=s(24836),i=s(30344),o=s(96446),a=s(81637),l=s(85865),d=s(19252),x=s(14194),c=s(11906),h=s(68903),p=s(63336),g=s(81045),A=s(43845),b=s(12110),u=s(26494),m=s(39336),j=s(88911),y=s(67784),f=s(51787),v=s(53193),w=s(79190),C=s(69285),k=s(32143),R=s(24010),S=s(67373),I=s(17392),W=s(35721),P=s(79650),E=s(71806),$=s(84882),z=s(28076),D=s(10039),M=s(73460),T=s(77739),F=s(19090),B=s(83462),O=s(4219),_=s(35316),L=s(74605),N=s(51962),q=s(29347),Y=s(26240),H=s(69974),U=s(59275),G=s(59893),V=s(74021),J=s(81626),K=s(80286),Q=s(71403),X=s(19454),Z=s(28460),ee=s(48304),re=s(47805),se=s(70141),te=s(79484),ne=s(59383),ie=s(33438),oe=s(3632),ae=s(83560),le=s(51387),de=s(37141),xe=s(64668),ce=s(8729),he=s(28393),pe=s(58390),ge=s(43278),Ae=s(39993),be=s(70579);const ue=t.forwardRef((function(e,r){return(0,be.jsx)(n.A,{direction:"up",ref:r,...e})}));function me(){const{expenses:e,loading:r,error:s,loadExpenses:n,addExpense:me,updateExpense:je,deleteExpense:ye,createProductFromExpense:fe,expensesLoaded:ve,expensesLoading:we}=(0,t.useContext)(xe.r),{user:Ce}=(0,t.useContext)(ce.c),ke=(0,Y.A)(),Re=(0,i.A)(ke.breakpoints.down("sm")),[Se,Ie]=(0,t.useState)(!1),[We,Pe]=(0,t.useState)("add"),[Ee,$e]=(0,t.useState)(null),[ze,De]=(0,t.useState)(!1),[Me,Te]=(0,t.useState)(!1),[Fe,Be]=(0,t.useState)(!1),[Oe,_e]=(0,t.useState)({description:"",amount:"",category:"",date:new Date,notes:"",isAsset:!1}),[Le,Ne]=(0,t.useState)(0),[qe,Ye]=(0,t.useState)(Re?5:10),[He,Ue]=(0,t.useState)(""),[Ge,Ve]=(0,t.useState)("");(0,t.useEffect)((()=>{(async()=>{if(!ve&&!we)try{await n()}catch(s){console.error("Error loading expenses:",s)}})()}),[n,ve,we]),(0,t.useEffect)((()=>{Ye(Re?5:10)}),[Re]);const Je=()=>{Pe("add"),_e({description:"",amount:"",category:"",date:new Date,notes:"",isAsset:!1}),Ie(!0)},Ke=e=>{Pe("edit"),$e(e),_e({description:e.description,amount:e.amount,category:e.category,date:new Date(e.date),notes:e.notes||"",isAsset:e.isAsset||!1}),Ie(!0)},Qe=()=>{Ie(!1),De(!1),Te(!1),Be(!1)},Xe=e=>{const{name:r,value:s}=e.target;_e((e=>({...e,[r]:s})))},Ze=e=>new Intl.NumberFormat("ms-MY",{style:"currency",currency:"MYR",minimumFractionDigits:2}).format(e),er=e=>{switch(e){case"Phone":return(0,be.jsx)(H.A,{});case"Rental":return(0,be.jsx)(U.A,{});case"Salary":return(0,be.jsx)(G.A,{});case"Accessories":return(0,be.jsx)(V.A,{});case"Marketing":return(0,be.jsx)(J.A,{});case"Transport":return(0,be.jsx)(K.A,{});case"Courier":return(0,be.jsx)(Q.A,{});case"Bonus":return(0,be.jsx)(X.A,{});case"Advertisement":return(0,be.jsx)(Z.A,{});default:return(0,be.jsx)(ee.A,{})}},rr=e=>{switch(e){case"Phone":case"Bonus":return"warning";case"Rental":return"error";case"Salary":return"primary";case"Accessories":case"Advertisement":return"info";case"Marketing":return"success";case"Transport":return"secondary";default:return"default"}},sr=e=>["Phone","Accessories"].includes(e),tr=e=>{$e(e),De(!0)},nr=e=>{$e(e),Te(!0)},ir=e.filter((e=>e.description.toLowerCase().includes(He.toLowerCase())&&(""===Ge||e.category===Ge))),or=ir.slice(Le*qe,Le*qe+qe),ar=e=>{try{return(0,Ae.A)(new Date(e),"dd MMM yyyy")}catch(s){return"Invalid date"}},{categoryTotals:lr}=(()=>{const r={},s={};return e.forEach((e=>{r[e.category]||(r[e.category]=0,s[e.category]=0),r[e.category]++,s[e.category]+=e.amount})),{categoryCounts:r,categoryTotals:s}})(),dr=e.reduce(((e,r)=>e+r.amount),0),xr=["Phone","Rental","Salary","Accessories","Marketing","Transport","Courier","Bonus","Advertisement","Other"];return we?(0,be.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh"},children:[(0,be.jsx)(a.A,{size:60,thickness:4,sx:{mb:2}}),(0,be.jsx)(l.A,{variant:"h6",color:"text.secondary",children:"Loading Expenses Data..."})]}):s?(0,be.jsx)(d.A,{sx:{py:4},children:(0,be.jsx)(x.A,{severity:"error",variant:"filled",action:(0,be.jsx)(c.A,{color:"inherit",size:"small",onClick:n,startIcon:(0,be.jsx)(re.A,{}),children:"Retry"}),sx:{borderRadius:4,boxShadow:"0 4px 12px rgba(211, 47, 47, 0.2)"},children:s})}):(0,be.jsx)(pe.$,{dateAdapter:he.h,children:(0,be.jsxs)(d.A,{disableGutters:Re,sx:{pb:Re?7:3},children:[(0,be.jsxs)(o.A,{sx:{pt:Re?2:3,pb:2,px:Re?2:3,background:"dark"===ke.palette.mode?`linear-gradient(135deg, ${ke.palette.error.dark}, ${ke.palette.primary.dark})`:`linear-gradient(135deg, ${ke.palette.error.main}, ${ke.palette.primary.main})`,borderRadius:Re?"0 0 24px 24px":"0 0 16px 16px",mb:3,color:"white",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:Re?1:2},children:[(0,be.jsx)(l.A,{variant:Re?"h5":"h4",sx:{fontWeight:600},children:"Expenses"}),!Re&&(0,be.jsx)(c.A,{variant:"contained",startIcon:(0,be.jsx)(se.A,{}),onClick:Je,sx:{borderRadius:8,px:3,py:1,bgcolor:"white",color:ke.palette.error.main,"&:hover":{bgcolor:"rgba(255,255,255,0.9)"},boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:"Add Expense"})]}),!Re&&(0,be.jsxs)(h.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,be.jsx)(h.Ay,{item:!0,xs:12,md:4,children:(0,be.jsxs)(p.A,{elevation:2,sx:{p:2,borderRadius:4,bgcolor:"rgba(255,255,255,0.9)",display:"flex",alignItems:"center",backdropFilter:"blur(10px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[(0,be.jsx)(g.A,{sx:{bgcolor:ke.palette.error.main,mr:2},children:er("Rental")}),(0,be.jsxs)(o.A,{children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Total Expenses"}),(0,be.jsx)(l.A,{variant:"h6",color:"error.main",sx:{fontWeight:"bold"},children:Ze(dr)})]})]})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,md:4,children:(0,be.jsxs)(p.A,{elevation:2,sx:{p:2,borderRadius:4,bgcolor:"rgba(255,255,255,0.9)",display:"flex",alignItems:"center",backdropFilter:"blur(10px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[(0,be.jsx)(g.A,{sx:{bgcolor:ke.palette.primary.main,mr:2},children:er("Salary")}),(0,be.jsxs)(o.A,{children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"This Month"}),(0,be.jsx)(l.A,{variant:"h6",sx:{fontWeight:"bold"},children:Ze(e.filter((e=>new Date(e.date).getMonth()===(new Date).getMonth())).reduce(((e,r)=>e+r.amount),0))})]})]})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,md:4,children:(0,be.jsxs)(p.A,{elevation:2,sx:{p:2,borderRadius:4,bgcolor:"rgba(255,255,255,0.9)",display:"flex",flexDirection:"column",alignItems:"flex-start",backdropFilter:"blur(10px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Top Category"}),Object.entries(lr).length>0?Object.entries(lr).sort(((e,r)=>r[1]-e[1])).slice(0,1).map((e=>{let[r,s]=e;return(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,be.jsx)(A.A,{icon:er(r),label:r,color:rr(r),sx:{mr:1}}),(0,be.jsx)(l.A,{variant:"body1",sx:{fontWeight:"bold",ml:"auto"},children:Ze(s)})]},r)})):(0,be.jsx)(l.A,{variant:"body1",children:"No expenses yet"})]})})]})]}),Re&&(0,be.jsx)(o.A,{sx:{px:2,mb:3},children:(0,be.jsx)(b.A,{elevation:2,sx:{borderRadius:4,overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,0.08)"},children:(0,be.jsxs)(u.A,{sx:{p:2},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Total Expenses"}),(0,be.jsx)(A.A,{label:`${e.length} items`,size:"small",sx:{height:24,"& .MuiChip-label":{px:1,py:0},fontWeight:500,bgcolor:"rgba(0,0,0,0.05)"}})]}),(0,be.jsx)(l.A,{variant:"h4",sx:{fontWeight:700,color:"error.main",my:1},children:Ze(dr)}),(0,be.jsx)(m.A,{sx:{my:1.5}}),Object.entries(lr).length>0?(0,be.jsx)(j.A,{spacing:1,children:Object.entries(lr).sort(((e,r)=>r[1]-e[1])).slice(0,2).map((e=>{let[r,s]=e;return(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,be.jsx)(o.A,{sx:{borderRadius:"8px",p:.5,mr:1,bgcolor:`${rr(r)}.light`,color:`${rr(r)}.main`,display:"flex"},children:er(r)}),(0,be.jsx)(l.A,{variant:"body2",children:r})]}),(0,be.jsx)(l.A,{variant:"body2",sx:{fontWeight:600},children:Ze(s)})]},r)}))}):(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:1},children:"No expenses recorded yet"})]})})}),(0,be.jsx)(o.A,{sx:{mb:3,px:Re?2:0},children:(0,be.jsxs)(h.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,be.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,be.jsx)(y.A,{fullWidth:!0,placeholder:"Search expenses",variant:"outlined",value:He,onChange:e=>Ue(e.target.value),InputProps:{startAdornment:(0,be.jsx)(f.A,{position:"start",children:(0,be.jsx)(te.A,{})}),sx:{borderRadius:8,backgroundColor:"white","& fieldset":{borderColor:"rgba(0, 0, 0, 0.08)"},boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"}}})}),!Re&&(0,be.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,be.jsxs)(v.A,{fullWidth:!0,variant:"outlined",children:[(0,be.jsx)(w.A,{children:"Filter by Category"}),(0,be.jsxs)(C.A,{value:Ge,onChange:e=>Ve(e.target.value),label:"Filter by Category",sx:{borderRadius:8,backgroundColor:"white",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},startAdornment:Ge?(0,be.jsx)(f.A,{position:"start",sx:{ml:1},children:er(Ge)}):null,children:[(0,be.jsx)(k.A,{value:"",children:"All Categories"}),xr.map((e=>(0,be.jsx)(k.A,{value:e,children:(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,be.jsx)(o.A,{sx:{mr:1,color:`${rr(e)}.main`,display:"flex"},children:er(e)}),e]})},e)))]})]})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,sm:12,md:4,sx:{display:"flex",justifyContent:{xs:"flex-end",md:"flex-end"}},children:(0,be.jsx)(c.A,{variant:"contained",color:"primary",startIcon:(0,be.jsx)(se.A,{}),onClick:Je,fullWidth:Re,size:Re?"large":"medium",sx:{borderRadius:8,py:Re?1.5:1.2,boxShadow:"0 4px 10px rgba(0, 122, 255, 0.3)"},children:"Add Expense"})})]})}),Re&&(0,be.jsx)(o.A,{sx:{px:2,mb:2,overflow:"auto"},children:(0,be.jsxs)(o.A,{sx:{display:"flex",gap:1,pb:.5},children:[(0,be.jsx)(A.A,{label:"All",color:""===Ge?"primary":"default",onClick:()=>Ve(""),sx:{borderRadius:8}}),xr.map((e=>(0,be.jsx)(A.A,{label:e,icon:er(e),color:Ge===e?rr(e):"default",variant:Ge===e?"filled":"outlined",onClick:()=>Ve(Ge===e?"":e),sx:{borderRadius:8}},e)))]})}),Re&&(0,be.jsx)(o.A,{sx:{position:"fixed",bottom:85,right:16,zIndex:10},children:(0,be.jsx)(R.A,{color:"primary","aria-label":"filter",onClick:()=>Be(!0),sx:{boxShadow:"0 4px 12px rgba(0, 122, 255, 0.5)"},children:(0,be.jsx)(ne.A,{})})}),Re&&(0,be.jsxs)(S.A,{anchor:"bottom",open:Fe,onClose:()=>Be(!1),onOpen:()=>Be(!0),disableSwipeToOpen:!1,PaperProps:{sx:{borderTopLeftRadius:20,borderTopRightRadius:20,pb:2}},children:[(0,be.jsx)(o.A,{sx:{width:"100%",height:4,bgcolor:"rgba(0,0,0,0.1)",mx:"auto",mt:1,borderRadius:2}}),(0,be.jsxs)(o.A,{sx:{p:2,borderBottom:"1px solid rgba(0, 0, 0, 0.05)"},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,be.jsx)(l.A,{variant:"h6",sx:{fontWeight:600},children:"Filter Expenses"}),(0,be.jsx)(I.A,{onClick:()=>Be(!1),children:(0,be.jsx)(ie.A,{})})]}),(0,be.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Category"}),(0,be.jsxs)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:3},children:[(0,be.jsx)(A.A,{label:"All",color:""===Ge?"primary":"default",onClick:()=>Ve(""),sx:{fontWeight:500,borderRadius:8}}),xr.map((e=>(0,be.jsx)(A.A,{label:e,icon:er(e),color:Ge===e?rr(e):"default",onClick:()=>Ve(e),sx:{fontWeight:500,borderRadius:8}},e)))]}),(0,be.jsxs)(o.A,{sx:{display:"flex",gap:2},children:[(0,be.jsx)(c.A,{variant:"outlined",color:"primary",fullWidth:!0,onClick:()=>{Ve(""),Be(!1)},sx:{borderRadius:8},children:"Reset"}),(0,be.jsx)(c.A,{variant:"contained",color:"primary",fullWidth:!0,onClick:()=>Be(!1),sx:{borderRadius:8},children:"Apply"})]})]})]}),Re&&ir.length>0&&(0,be.jsx)(o.A,{sx:{px:2,mb:2},children:(0,be.jsx)(W.A,{sx:{p:0},children:or.map((e=>(0,be.jsx)(b.A,{sx:{mb:2,borderRadius:4,overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,0.04)",transition:"transform 0.2s, box-shadow 0.2s","&:active":{transform:"scale(0.98)",boxShadow:"0 1px 5px rgba(0,0,0,0.05)"}},onClick:()=>tr(e),children:(0,be.jsxs)(u.A,{sx:{p:2},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[(0,be.jsx)(g.A,{sx:{bgcolor:`${rr(e.category)}.main`,width:40,height:40,mr:2},children:er(e.category)}),(0,be.jsxs)(o.A,{sx:{flex:1},children:[(0,be.jsx)(l.A,{variant:"subtitle1",sx:{fontWeight:600,lineHeight:1.2},children:e.description}),(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mt:.5},children:[(0,be.jsx)(A.A,{label:e.category,size:"small",color:rr(e.category),sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem",fontWeight:600}}}),(0,be.jsx)(l.A,{variant:"caption",color:"text.secondary",sx:{ml:1},children:ar(e.date)})]})]}),(0,be.jsx)(l.A,{variant:"subtitle1",sx:{fontWeight:700,color:"error.main",ml:1},children:Ze(e.amount)})]}),e.notes&&(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.8rem",pl:7,pr:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.notes}),e.isAsset&&(0,be.jsx)(o.A,{sx:{display:"flex",alignItems:"center",mt:1,pl:7},children:(0,be.jsx)(A.A,{label:"Asset",size:"small",color:"info",variant:"outlined",sx:{height:20,"& .MuiChip-label":{px:1,fontSize:"0.7rem",fontWeight:500}}})})]})},e._id)))})}),0===ir.length&&(0,be.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:4,my:4,textAlign:"center"},children:[(0,be.jsx)(g.A,{sx:{width:80,height:80,mb:2,bgcolor:"primary.light",color:"primary.main"},children:(0,be.jsx)(ee.A,{sx:{fontSize:40}})}),(0,be.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"No expenses found"}),(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:2,maxWidth:300},children:He||Ge?"Try adjusting your filters to see more results":"You haven't added any expenses yet. Start by adding your first expense."}),(0,be.jsx)(c.A,{variant:"contained",color:"primary",startIcon:(0,be.jsx)(se.A,{}),onClick:Je,sx:{borderRadius:8,px:3},children:"Add Expense"})]}),!Re&&ir.length>0&&(0,be.jsx)(P.A,{component:p.A,sx:{borderRadius:4,boxShadow:"0 2px 10px rgba(0,0,0,0.05)",overflow:"hidden",mb:3,mx:0},children:(0,be.jsxs)(E.A,{children:[(0,be.jsx)($.A,{sx:{bgcolor:"rgba(0,0,0,0.02)"},children:(0,be.jsxs)(z.A,{children:[(0,be.jsx)(D.A,{width:"10%",children:"Category"}),(0,be.jsx)(D.A,{width:"20%",children:"Description"}),(0,be.jsx)(D.A,{width:"20%",children:"Date"}),(0,be.jsx)(D.A,{width:"15%",children:"Amount"}),(0,be.jsx)(D.A,{width:"20%",children:"Notes"}),(0,be.jsx)(D.A,{width:"15%",align:"right",children:"Actions"})]})}),(0,be.jsx)(M.A,{children:or.map((e=>(0,be.jsxs)(z.A,{sx:{"&:hover":{bgcolor:"rgba(0,0,0,0.01)"},transition:"background-color 0.2s"},children:[(0,be.jsx)(D.A,{children:(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,be.jsx)(g.A,{sx:{bgcolor:`${rr(e.category)}.main`,width:28,height:28,mr:1.5},children:er(e.category)}),(0,be.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column"},children:[(0,be.jsx)(l.A,{variant:"body2",sx:{fontWeight:500},children:e.category}),e.isAsset&&(0,be.jsx)(A.A,{label:"Asset",size:"small",color:"info",variant:"outlined",sx:{height:16,mt:.5,"& .MuiChip-label":{px:.5,fontSize:"0.6rem",fontWeight:500}}})]})]})}),(0,be.jsx)(D.A,{children:(0,be.jsx)(l.A,{variant:"body2",sx:{fontWeight:500},children:e.description})}),(0,be.jsx)(D.A,{children:(0,be.jsx)(l.A,{variant:"body2",children:ar(e.date)})}),(0,be.jsx)(D.A,{children:(0,be.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,color:"error.main"},children:Ze(e.amount)})}),(0,be.jsx)(D.A,{children:(0,be.jsx)(l.A,{variant:"body2",sx:{color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:150},children:e.notes||"-"})}),(0,be.jsx)(D.A,{align:"right",children:(0,be.jsxs)(o.A,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,be.jsx)(T.A,{title:"View",children:(0,be.jsx)(I.A,{size:"small",onClick:()=>tr(e),sx:{color:"info.main"},children:(0,be.jsx)(oe.A,{fontSize:"small"})})}),(0,be.jsx)(T.A,{title:"Edit",children:(0,be.jsx)(I.A,{size:"small",onClick:()=>Ke(e),sx:{color:"primary.main",mx:.5},children:(0,be.jsx)(ae.A,{fontSize:"small"})})}),(0,be.jsx)(T.A,{title:"Delete",children:(0,be.jsx)(I.A,{size:"small",onClick:()=>nr(e),sx:{color:"error.main"},children:(0,be.jsx)(le.A,{fontSize:"small"})})})]})})]},e._id)))})]})}),ir.length>0&&(0,be.jsx)(F.A,{component:"div",count:ir.length,page:Le,onPageChange:(e,r)=>{Ne(r)},rowsPerPage:qe,onRowsPerPageChange:e=>{Ye(parseInt(e.target.value,10)),Ne(0)},rowsPerPageOptions:Re?[5,10]:[10,25,50],sx:{borderTop:"1px solid rgba(0,0,0,0.05)",".MuiTablePagination-toolbar":{paddingLeft:Re?1:2},".MuiTablePagination-selectLabel, .MuiTablePagination-displayedRows":{fontSize:"0.875rem"}}}),(0,be.jsxs)(B.A,{open:Se,onClose:Qe,fullScreen:Re,TransitionComponent:ue,PaperProps:{sx:{borderRadius:Re?0:4,overflow:"hidden",backgroundImage:"dark"===ke.palette.mode?`linear-gradient(to bottom, ${ke.palette.background.paper}, ${ke.palette.background.paper})`:"linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(255,255,255,1))",boxShadow:"0 0 20px rgba(0,0,0,0.1)",width:Re?"100%":"550px",maxHeight:Re?"100%":"85vh"}},children:[(0,be.jsxs)(o.A,{sx:{px:3,pt:2,pb:1,bgcolor:"dark"===ke.palette.mode?`linear-gradient(135deg, ${ke.palette.error.dark}, ${ke.palette.primary.dark})`:`linear-gradient(135deg, ${ke.palette.error.main}, ${ke.palette.primary.main})`,color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,be.jsx)(O.A,{sx:{p:0,fontSize:"1.2rem",fontWeight:600},children:"add"===We?"Add New Expense":"Edit Expense"}),(0,be.jsx)(I.A,{edge:"end",color:"inherit",onClick:Qe,"aria-label":"close",children:(0,be.jsx)(ie.A,{})})]}),(0,be.jsx)(_.A,{sx:{px:3,pt:3,pb:1,overflowY:"auto"},children:(0,be.jsxs)(h.Ay,{container:!0,spacing:2,children:[(0,be.jsx)(h.Ay,{item:!0,xs:12,children:(0,be.jsx)(y.A,{name:"description",label:"Description",value:Oe.description,onChange:Xe,fullWidth:!0,variant:"outlined",required:!0,autoFocus:!0,InputProps:{sx:{borderRadius:2,backgroundColor:"rgba(0,0,0,0.02)"}}})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,sm:6,children:(0,be.jsx)(y.A,{name:"amount",label:"Amount (MYR)",value:Oe.amount,onChange:Xe,fullWidth:!0,variant:"outlined",required:!0,type:"number",InputProps:{startAdornment:(0,be.jsx)(f.A,{position:"start",children:"RM"}),sx:{borderRadius:2,backgroundColor:"rgba(0,0,0,0.02)"}}})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,sm:6,children:(0,be.jsxs)(v.A,{fullWidth:!0,variant:"outlined",required:!0,children:[(0,be.jsx)(w.A,{children:"Category"}),(0,be.jsx)(C.A,{name:"category",label:"Category",value:Oe.category,onChange:Xe,IconComponent:e=>(0,be.jsx)(ee.A,{...e,color:"action"}),sx:{borderRadius:2,backgroundColor:"rgba(0,0,0,0.02)"},children:xr.map((e=>(0,be.jsx)(k.A,{value:e,children:(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,be.jsx)(o.A,{sx:{mr:1.5,color:`${rr(e)}.main`,display:"flex"},children:er(e)}),e]})},e)))})]})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,children:(0,be.jsx)(ge.l,{label:"Date",value:Oe.date,onChange:e=>{_e((r=>({...r,date:e})))},slotProps:{textField:{fullWidth:!0,variant:"outlined",sx:{"& .MuiInputBase-root":{borderRadius:2,backgroundColor:"rgba(0,0,0,0.02)"}}}}})}),(0,be.jsx)(h.Ay,{item:!0,xs:12,children:(0,be.jsx)(y.A,{name:"notes",label:"Notes",value:Oe.notes,onChange:Xe,fullWidth:!0,variant:"outlined",multiline:!0,rows:3,InputProps:{sx:{borderRadius:2,backgroundColor:"rgba(0,0,0,0.02)"}}})}),(cr=Oe.category,["Phone","Accessories","Marketing","Transport","Other"].includes(cr)&&(0,be.jsx)(h.Ay,{item:!0,xs:12,children:(0,be.jsx)(L.A,{control:(0,be.jsx)(N.A,{name:"isAsset",checked:Oe.isAsset,onChange:e=>{const{name:r,checked:s}=e.target;_e((e=>({...e,[r]:s})))},color:"primary"}),label:(0,be.jsx)(l.A,{variant:"body2",children:"Track as asset (appears in Products/Assets)"})})}))]})}),(0,be.jsxs)(q.A,{sx:{px:3,py:2,justifyContent:"flex-end"},children:[(0,be.jsx)(c.A,{onClick:Qe,sx:{borderRadius:8,px:3,color:"text.secondary","&:hover":{backgroundColor:"rgba(0,0,0,0.05)"}},children:"Cancel"}),(0,be.jsx)(c.A,{onClick:async()=>{if(Oe.description&&Oe.amount&&Oe.category)try{const e={...Oe,amount:parseFloat(Oe.amount),paidBy:Ce._id};let r;if(sr(Oe.category)&&(e.isAsset=!0),r="add"===We?await me(e):await je(Ee._id,e),r&&sr(r.category))try{const e={name:r.description,description:r.notes||`${r.category} expense`,category:r.category,purchasePrice:r.amount,quantity:1,purchaseDate:r.date,isAsset:!0,relatedExpense:r._id};await fe(e),console.log("Product created successfully from expense")}catch(s){console.error("Error creating product from expense:",s)}Qe()}catch(s){console.error("Error submitting expense:",s),alert("Error saving expense. Please try again.")}else alert("Please fill in all required fields: Description, Amount, and Category")},variant:"contained",color:"primary",startIcon:(0,be.jsx)(de.A,{}),sx:{borderRadius:8,px:3,boxShadow:"0 4px 10px rgba(0, 122, 255, 0.3)"},children:"add"===We?"Add Expense":"Save Changes"})]})]}),(0,be.jsx)(B.A,{open:ze,onClose:Qe,fullScreen:Re,TransitionComponent:ue,PaperProps:{sx:{borderRadius:Re?0:4,overflow:"hidden",width:Re?"100%":"500px",backgroundImage:"dark"===ke.palette.mode?`linear-gradient(to bottom, ${ke.palette.background.paper}, ${ke.palette.background.paper})`:"linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(255,255,255,1))",boxShadow:"0 0 20px rgba(0,0,0,0.1)"}},children:Ee&&(0,be.jsxs)(be.Fragment,{children:[(0,be.jsxs)(o.A,{sx:{px:3,pt:2,pb:1,bgcolor:"dark"===ke.palette.mode?`linear-gradient(135deg, ${ke.palette.error.dark}, ${ke.palette.primary.dark})`:`linear-gradient(135deg, ${ke.palette.error.main}, ${ke.palette.primary.main})`,color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,be.jsx)(O.A,{sx:{p:0,fontSize:"1.2rem",fontWeight:600},children:"Expense Details"}),(0,be.jsx)(I.A,{edge:"end",color:"inherit",onClick:Qe,"aria-label":"close",children:(0,be.jsx)(ie.A,{})})]}),(0,be.jsxs)(_.A,{sx:{px:3,pt:3,pb:0},children:[(0,be.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,be.jsx)(g.A,{sx:{bgcolor:`${rr(Ee.category)}.main`,width:56,height:56,mr:2},children:er(Ee.category)}),(0,be.jsxs)(o.A,{children:[(0,be.jsx)(l.A,{variant:"h6",sx:{fontWeight:600,lineHeight:1.2},children:Ee.description}),(0,be.jsx)(A.A,{label:Ee.category,color:rr(Ee.category),size:"small",sx:{mt:.5}})]})]}),(0,be.jsxs)(p.A,{elevation:0,sx:{p:2,mb:3,borderRadius:3,backgroundColor:"rgba(0,0,0,0.03)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Amount"}),(0,be.jsx)(l.A,{variant:"h5",color:"error.main",sx:{fontWeight:700},children:Ze(Ee.amount)})]}),(0,be.jsxs)(h.Ay,{container:!0,spacing:2,sx:{mb:2},children:[(0,be.jsx)(h.Ay,{item:!0,xs:6,children:(0,be.jsxs)(p.A,{elevation:0,sx:{p:2,borderRadius:3,backgroundColor:"rgba(0,0,0,0.03)",height:"100%"},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Date"}),(0,be.jsx)(l.A,{variant:"body1",sx:{fontWeight:500},children:ar(Ee.date)})]})}),(0,be.jsx)(h.Ay,{item:!0,xs:6,children:(0,be.jsxs)(p.A,{elevation:0,sx:{p:2,borderRadius:3,backgroundColor:"rgba(0,0,0,0.03)",height:"100%"},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Status"}),(0,be.jsx)(o.A,{sx:{display:"flex",alignItems:"center"},children:Ee.isAsset?(0,be.jsx)(A.A,{label:"Asset",color:"info",size:"small"}):(0,be.jsx)(A.A,{label:"Expense",color:"default",size:"small"})})]})})]}),Ee.notes&&(0,be.jsxs)(o.A,{sx:{mb:3},children:[(0,be.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Notes"}),(0,be.jsx)(l.A,{variant:"body1",children:Ee.notes})]})]}),(0,be.jsxs)(q.A,{sx:{px:3,py:2,justifyContent:"space-between"},children:[(0,be.jsx)(c.A,{color:"error",startIcon:(0,be.jsx)(le.A,{}),onClick:()=>{nr(Ee),Qe()},sx:{borderRadius:8},children:"Delete"}),(0,be.jsx)(c.A,{variant:"contained",color:"primary",startIcon:(0,be.jsx)(ae.A,{}),onClick:()=>{Ke(Ee),Qe()},sx:{borderRadius:8},children:"Edit"})]})]})}),(0,be.jsx)(B.A,{open:Me,onClose:()=>{r||Qe()},TransitionComponent:ue,PaperProps:{sx:{borderRadius:4,overflow:"hidden",maxWidth:"450px"}},children:Ee&&(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(O.A,{sx:{pt:3,px:3},children:(0,be.jsx)(l.A,{variant:"h6",sx:{fontWeight:600},children:"Delete Expense"})}),(0,be.jsxs)(_.A,{sx:{px:3,pt:1},children:[s&&(0,be.jsx)(x.A,{severity:"error",sx:{mb:2,borderRadius:2},children:s}),(0,be.jsx)(l.A,{variant:"body1",sx:{mb:2},children:"Are you sure you want to delete this expense?"}),(0,be.jsxs)(p.A,{elevation:0,sx:{p:2,borderRadius:3,backgroundColor:"rgba(0,0,0,0.03)",display:"flex",alignItems:"center"},children:[(0,be.jsx)(g.A,{sx:{bgcolor:`${rr(Ee.category)}.main`,width:40,height:40,mr:2},children:er(Ee.category)}),(0,be.jsxs)(o.A,{sx:{flex:1},children:[(0,be.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:500,lineHeight:1.2},children:Ee.description}),(0,be.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:[Ze(Ee.amount)," \u2022 ",ar(Ee.date)]})]})]})]}),(0,be.jsxs)(q.A,{sx:{px:3,py:2},children:[(0,be.jsx)(c.A,{onClick:Qe,disabled:r,sx:{borderRadius:8,px:3,color:"text.secondary"},children:"Cancel"}),(0,be.jsx)(c.A,{onClick:async()=>{try{Te(!0),console.log(`Attempting to delete expense: ${Ee._id}`);await ye(Ee._id)?(console.log("Delete successful, closing dialogs"),Te(!1),Qe()):(console.error(`Delete failed, error: ${s}`),s||alert("Failed to delete expense: Unknown error"))}catch(e){console.error("Error in delete confirmation:",e),alert(`Failed to delete expense: ${e.message||"Unknown error"}`)}},variant:"contained",color:"error",disabled:r,startIcon:r?(0,be.jsx)(a.A,{size:16,color:"inherit"}):null,sx:{borderRadius:8,px:3},children:r?"Deleting...":"Delete"})]})]})}),Re&&(0,be.jsx)(o.A,{sx:{position:"fixed",bottom:16,right:16,zIndex:10},children:(0,be.jsx)(R.A,{color:"primary","aria-label":"add expense",onClick:Je,sx:{boxShadow:"0 4px 12px rgba(0, 122, 255, 0.5)","&:hover":{bgcolor:"primary.dark"}},children:(0,be.jsx)(se.A,{})})})]})});var cr}}}]);
//# sourceMappingURL=640.0d4bdbe1.chunk.js.map