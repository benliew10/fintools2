"use strict";(self.webpackChunkfintools_client=self.webpackChunkfintools_client||[]).push([[985],{16985:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var n=r(65043),s=r(30344),i=r(96446),a=r(81637),o=r(85865),l=r(77739),c=r(17392),d=r(68903),x=r(12110),h=r(26494),m=r(39336),g=r(88911),u=r(26240),p=r(47805),b=r(7967),f=r(42796),y=r(94389),j=r(59540),A=r(88645),v=r(64668),k=r(50108),F=r(75748),w=r(87734),C=r(52185),R=r(6026),W=r(86150),D=r(21327),S=r(90168),M=r(60163),I=r(4240),N=r(17869),z=r(81045),E=r(27012),L=r(99010),B=r(79641),T=r(70579);const Y=e=>{let{isMobile:t}=e;const{financialSummary:r}=(0,n.useContext)(v.r),s=e=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR",minimumFractionDigits:2}).format(e||0),a=[{title:"Total Revenue",value:s(r.totalRevenue||0),icon:(0,T.jsx)(E.A,{}),color:"#34C759"},{title:"Total Expenses",value:s(r.totalExpenses||0),icon:(0,T.jsx)(L.A,{}),color:"#FF3B30"},{title:"Net Profit",value:s((r.totalRevenue||0)-(r.totalExpenses||0)),icon:(0,T.jsx)(f.A,{}),color:"#007AFF"},{title:"Asset Value",value:s(r.totalAssets||0),icon:(0,T.jsx)(B.A,{}),color:"#5856D6"}];return(0,T.jsx)(i.A,{sx:{p:3,pt:2},children:(0,T.jsx)(d.Ay,{container:!0,spacing:t?2:3,children:a.map(((e,r)=>(0,T.jsxs)(d.Ay,{item:!0,xs:12,sm:6,children:[(0,T.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,T.jsx)(z.A,{sx:{bgcolor:`${e.color}20`,color:e.color,mr:2},children:e.icon}),(0,T.jsxs)(i.A,{children:[(0,T.jsx)(o.A,{variant:"body2",color:"text.secondary",children:e.title}),(0,T.jsx)(o.A,{variant:"h6",sx:{fontWeight:600},children:e.value})]})]}),t&&r<a.length-1&&(0,T.jsx)(m.A,{sx:{opacity:.6,mb:2}})]},r)))})})};var $=r(35721),K=r(37918),J=r(23851),O=r(48734),_=r(43845),P=r(47225),G=r(39993);const V=e=>{let{isMobile:t}=e;const{revenues:r,expenses:s}=(0,n.useContext)(v.r),a=e=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR",minimumFractionDigits:2}).format(e),l=e=>{try{return(0,G.A)(new Date(e),"dd MMM yyyy")}catch(t){return"Invalid date"}},c=[...r.map((e=>({...e,type:"revenue"}))),...s.map((e=>({...e,type:"expense"})))].sort(((e,t)=>new Date(t.date)-new Date(e.date))).slice(0,5);return(0,T.jsx)(i.A,{children:c.length>0?(0,T.jsx)($.A,{sx:{p:0},children:c.map(((e,t)=>(0,T.jsxs)(n.Fragment,{children:[(0,T.jsxs)(K.Ay,{alignItems:"flex-start",sx:{px:3,py:2,transition:"background-color 0.2s","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.02)"}},children:[(0,T.jsx)(J.A,{children:(0,T.jsx)(z.A,{sx:{bgcolor:"revenue"===e.type?"success.light":"error.light",color:"revenue"===e.type?"success.main":"error.main"},children:"revenue"===e.type?(0,T.jsx)(f.A,{}):(0,T.jsx)(y.A,{})})}),(0,T.jsx)(O.A,{primary:(0,T.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,T.jsx)(o.A,{variant:"body1",sx:{fontWeight:500,mr:1,flex:1},children:e.description}),(0,T.jsx)(o.A,{variant:"body1",sx:{fontWeight:600,color:"revenue"===e.type?"success.main":"error.main"},children:"revenue"===e.type?a(e.amount):`-${a(e.amount)}`})]}),secondary:(0,T.jsxs)(i.A,{sx:{display:"flex",mt:.5,alignItems:"center"},children:[(0,T.jsx)(_.A,{label:e.category,size:"small",sx:{mr:1,height:20,fontSize:"0.7rem",fontWeight:500,bgcolor:"revenue"===e.type?"success.light":"error.light",color:"revenue"===e.type?"success.dark":"error.dark","& .MuiChip-label":{px:1}}}),(0,T.jsxs)(i.A,{sx:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(P.A,{sx:{fontSize:"0.875rem",mr:.5,color:"text.secondary"}}),(0,T.jsx)(o.A,{variant:"caption",color:"text.secondary",children:l(e.date)})]})]})})]}),t<c.length-1&&(0,T.jsx)(m.A,{})]},e._id)))}):(0,T.jsxs)(i.A,{sx:{p:3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:t?150:200,bgcolor:"rgba(0,0,0,0.02)",borderRadius:2,m:2},children:[(0,T.jsx)(o.A,{variant:"body1",color:"text.secondary",align:"center",children:"No recent transactions"}),(0,T.jsx)(o.A,{variant:"body2",color:"text.secondary",align:"center",sx:{mt:1},children:"Transactions will appear here as you add them"})]})})},q=()=>{const{financialSummary:e,revenues:t,expenses:r,loading:z,expensesLoading:E,revenuesLoading:L,refreshData:B,loadFinancialSummary:$}=(0,n.useContext)(v.r),[K,J]=(0,n.useState)(!1),O=(0,u.A)(),_=(0,s.A)(O.breakpoints.down("sm"));(0,n.useEffect)((()=>{let t=!0;console.log("Dashboard component mounted");return(async()=>{if(K)console.log("Already refreshing data, skipping");else if(e.dataLoaded)console.log("Financial summary already loaded, skipping refresh");else{console.log("Refreshing financial data"),J(!0);try{await $(),t&&console.log("Financial summary refreshed on dashboard mount")}catch(r){console.error("Error refreshing dashboard data:",r)}finally{t&&J(!1)}}})(),()=>{t=!1}}),[$,K,e.dataLoaded]);const P=[{name:"Revenue",value:e.totalRevenue||0},{name:"Expenses",value:e.totalExpenses||0}],G=(()=>{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=(new Date).getMonth(),s=[];for(let t=5;t>=0;t--){const r=(n-t+12)%12;s.push(e[r])}return s.map((n=>{const s=t.filter((t=>new Date(t.date).getMonth()===e.indexOf(n))),i=r.filter((t=>new Date(t.date).getMonth()===e.indexOf(n))),a=s.reduce(((e,t)=>e+t.amount),0),o=i.reduce(((e,t)=>e+t.amount),0);return{name:n,revenue:a,expense:o,profit:a-o}}))})(),q=(()=>{if(G.length<2)return 0;const e=G[G.length-1].profit,t=G[G.length-2].profit;return 0===t?e>0?100:0:(e-t)/Math.abs(t)*100})(),H=q>=0,Q=e=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR",minimumFractionDigits:2}).format(e);return z||E||L?(0,T.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh"},children:[(0,T.jsx)(a.A,{size:60,thickness:4,sx:{mb:2}}),(0,T.jsx)(o.A,{variant:"h6",color:"text.secondary",children:"Loading Dashboard Data..."})]}):(0,T.jsxs)(i.A,{sx:{flexGrow:1,p:_?1:3},children:[(0,T.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,px:_?1:0},children:[(0,T.jsx)(o.A,{variant:_?"h5":"h4",component:"h1",sx:{fontWeight:700,fontSize:_?"1.5rem":"2.125rem",background:"linear-gradient(45deg, #007AFF, #5AC8FA)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Dashboard"}),(0,T.jsx)(l.A,{title:"Refresh data",children:(0,T.jsx)(c.A,{onClick:async()=>{J(!0);try{await B()}catch(e){console.error("Error refreshing dashboard data:",e)}finally{J(!1)}},disabled:K,sx:{background:"rgba(0, 122, 255, 0.1)","&:hover":{background:"rgba(0, 122, 255, 0.2)"}},children:(0,T.jsx)(p.A,{sx:{animation:K?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})})]}),(0,T.jsxs)(d.Ay,{container:!0,spacing:_?2:3,children:[(0,T.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,T.jsx)(x.A,{elevation:0,className:"ios-shadow",sx:{borderRadius:4,height:"100%",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,1) 100%)",backdropFilter:"blur(20px)"},children:(0,T.jsxs)(h.A,{sx:{p:0},children:[(0,T.jsx)(i.A,{sx:{p:3,pb:1},children:(0,T.jsxs)(o.A,{variant:"h6",component:"h2",sx:{fontWeight:600,display:"flex",alignItems:"center",mb:3,fontSize:_?"1rem":"1.25rem"},children:[(0,T.jsx)(b.A,{sx:{mr:1,color:O.palette.primary.main}}),"Financial Summary"]})}),(0,T.jsx)(m.A,{}),(0,T.jsx)(Y,{isMobile:_})]})})}),(0,T.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,T.jsx)(x.A,{elevation:0,className:"ios-shadow",sx:{borderRadius:4,height:"100%",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,1) 100%)",backdropFilter:"blur(20px)"},children:(0,T.jsxs)(h.A,{children:[(0,T.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,T.jsxs)(o.A,{variant:"h6",component:"h2",sx:{fontWeight:600,display:"flex",alignItems:"center",fontSize:_?"1rem":"1.25rem"},children:[H?(0,T.jsx)(f.A,{sx:{mr:1,color:"#34C759"}}):(0,T.jsx)(y.A,{sx:{mr:1,color:"#FF3B30"}}),"Profit Trend"]}),(0,T.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",px:1.5,py:.5,borderRadius:5,backgroundColor:H?"rgba(52, 199, 89, 0.1)":"rgba(255, 59, 48, 0.1)",color:H?"#34C759":"#FF3B30"},children:[H?(0,T.jsx)(j.A,{sx:{fontSize:"0.875rem",mr:.5}}):(0,T.jsx)(A.A,{sx:{fontSize:"0.875rem",mr:.5}}),(0,T.jsxs)(o.A,{variant:"body2",sx:{fontWeight:600},children:[Math.abs(q).toFixed(1),"%"]})]})]}),(0,T.jsx)(i.A,{sx:{height:250,mt:3},children:t.length>0||r.length>0?(0,T.jsx)(k.u,{width:"100%",height:"100%",children:(0,T.jsxs)(F.b,{data:G,margin:{top:5,right:20,left:0,bottom:5},children:[(0,T.jsx)(w.d,{strokeDasharray:"3 3",stroke:"rgba(0,0,0,0.05)"}),(0,T.jsx)(C.W,{dataKey:"name",tick:{fontSize:12},tickLine:!1,axisLine:{stroke:"rgba(0,0,0,0.1)"}}),(0,T.jsx)(R.h,{tickFormatter:e=>`RM${e}`,tick:{fontSize:12},tickLine:!1,axisLine:{stroke:"rgba(0,0,0,0.1)"}}),(0,T.jsx)(W.m,{formatter:e=>Q(e),labelStyle:{fontWeight:"bold"},contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"8px 12px"}}),(0,T.jsx)(D.s,{wrapperStyle:{fontSize:12,paddingTop:10}}),(0,T.jsx)(S.N,{type:"monotone",dataKey:"revenue",stroke:"#34C759",strokeWidth:2,dot:{stroke:"#34C759",strokeWidth:2,r:4,fill:"white"},activeDot:{r:6,stroke:"#34C759",strokeWidth:2,fill:"white"}}),(0,T.jsx)(S.N,{type:"monotone",dataKey:"expense",stroke:"#FF3B30",strokeWidth:2,dot:{stroke:"#FF3B30",strokeWidth:2,r:4,fill:"white"},activeDot:{r:6,stroke:"#FF3B30",strokeWidth:2,fill:"white"}}),(0,T.jsx)(S.N,{type:"monotone",dataKey:"profit",stroke:"#007AFF",strokeWidth:2.5,dot:{stroke:"#007AFF",strokeWidth:2,r:4,fill:"white"},activeDot:{r:6,stroke:"#007AFF",strokeWidth:2,fill:"white"}})]})}):(0,T.jsxs)(i.A,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",p:3,backgroundColor:"rgba(0,0,0,0.02)",borderRadius:2},children:[(0,T.jsx)(o.A,{variant:"body1",color:"text.secondary",align:"center",children:"No transaction data available"}),(0,T.jsx)(o.A,{variant:"body2",color:"text.secondary",align:"center",sx:{mt:1},children:"Add revenues and expenses to see your financial trend"})]})})]})})}),(0,T.jsx)(d.Ay,{item:!0,xs:12,md:5,children:(0,T.jsx)(x.A,{elevation:0,className:"ios-shadow",sx:{borderRadius:4,height:"100%",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,1) 100%)",backdropFilter:"blur(20px)"},children:(0,T.jsxs)(h.A,{children:[(0,T.jsx)(o.A,{variant:"h6",component:"h2",sx:{fontWeight:600,mb:3,fontSize:_?"1rem":"1.25rem"},children:"Revenue & Expense Distribution"}),(0,T.jsx)(i.A,{sx:{height:250,display:"flex",justifyContent:"center"},children:e.totalRevenue>0||e.totalExpenses>0?(0,T.jsx)(k.u,{width:"100%",height:"100%",children:(0,T.jsxs)(M.r,{children:[(0,T.jsx)(I.F,{data:P,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:t,percent:r}=e;return`${t} ${(100*r).toFixed(0)}%`},children:P.map(((e,t)=>(0,T.jsx)(N.f,{fill:0===t?"#34C759":"#FF3B30"},`cell-${t}`)))}),(0,T.jsx)(W.m,{formatter:e=>Q(e),contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"8px 12px"}})]})}):(0,T.jsx)(i.A,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:3,backgroundColor:"rgba(0,0,0,0.02)",borderRadius:2},children:(0,T.jsx)(o.A,{variant:"body1",color:"text.secondary",align:"center",children:"No data available for distribution chart"})})}),(0,T.jsx)(i.A,{sx:{mt:2},children:(0,T.jsxs)(g.A,{direction:"row",spacing:2,sx:{mt:2},children:[(0,T.jsxs)(i.A,{sx:{flex:1},children:[(0,T.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Total Revenue"}),(0,T.jsx)(o.A,{variant:"h6",sx:{color:"#34C759",fontWeight:600},children:Q(e.totalRevenue||0)})]}),(0,T.jsxs)(i.A,{sx:{flex:1},children:[(0,T.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Total Expenses"}),(0,T.jsx)(o.A,{variant:"h6",sx:{color:"#FF3B30",fontWeight:600},children:Q(e.totalExpenses||0)})]})]})})]})})}),(0,T.jsx)(d.Ay,{item:!0,xs:12,md:7,children:(0,T.jsx)(x.A,{elevation:0,className:"ios-shadow",sx:{borderRadius:4,height:"100%",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,1) 100%)",backdropFilter:"blur(20px)"},children:(0,T.jsxs)(h.A,{sx:{p:0},children:[(0,T.jsx)(i.A,{sx:{p:3,pb:1},children:(0,T.jsx)(o.A,{variant:"h6",component:"h2",sx:{fontWeight:600,fontSize:_?"1rem":"1.25rem"},children:"Recent Transactions"})}),(0,T.jsx)(m.A,{}),(0,T.jsx)(V,{isMobile:_})]})})})]})]})}}}]);
//# sourceMappingURL=985.46fa2b14.chunk.js.map